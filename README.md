# CIA
Code for **CIA: Inferring the Communication Topology from LLM-based Multi-Agent Systems**

![fig](CIA.png)

#### Stage 1: Obtain the trained generative topology model.
We select three well-performing generative optimization strategies: [G-Designer](https://github.com/yanweiyue/GDesigner/tree/main), [AGP](https://github.com/Resurgamm/AGP), and [ARG-Designer](https://github.com/Shiy-Li/ARG-Designer/tree/main).

The detailed training procedure can be found in the corresponding README.md. Taking G-Designer as an example, by running /experiment/run_{domain}.py, we can obtain the corresponding .pt checkpoint file.

#### Stage 2: Reasoning Output Induction.
```bash
cd CIA
python reasoning_output_induction.py
```
Obtain the reasoning outputs and the ground truth of MAS generated by model we trained in Stage 1.

For each task, we have /{self.domain}/reasoning_outputs/{i_batch}_{i_record}.json
#### Stage 3: Semantic Correlations Modeling.
```bash
cd CIA
python semantic_correlations_modeling.py
```
Infer the communication topology and evaluate the performance.

For each domain, the input path is /{self.domain}/reasoning_outputs
